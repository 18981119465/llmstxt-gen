# å‘Šè­¦è§„åˆ™é…ç½®
alerts:
  # å‘Šè­¦çº§åˆ«å®šä¹‰
  levels:
    DEBUG:
      priority: 1
      color: "#36a64f"  # ç»¿è‰²
      escalation_minutes: 0
    INFO:
      priority: 2
      color: "#36a64f"  # ç»¿è‰²
      escalation_minutes: 0
    WARNING:
      priority: 3
      color: "#ff9500"  # æ©™è‰²
      escalation_minutes: 15
    ERROR:
      priority: 4
      color: "#ff4d4f"  # çº¢è‰²
      escalation_minutes: 5
    CRITICAL:
      priority: 5
      color: "#722ed1"  # ç´«è‰²
      escalation_minutes: 1

  # å‘Šè­¦è§„åˆ™
  rules:
    # ç³»ç»Ÿèµ„æºå‘Šè­¦
    - name: high_cpu_usage
      description: "CPUä½¿ç”¨ç‡è¿‡é«˜"
      condition: "system.cpu.usage > 80"
      duration: "5m"
      level: WARNING
      enabled: true
      tags: [system, cpu, performance]
      message: "CPUä½¿ç”¨ç‡è¿‡é«˜: {{value}}%"
      actions:
        - type: notify
          channels: [slack, email]
        - type: auto_scale
          enabled: false
    
    - name: critical_cpu_usage
      description: "CPUä½¿ç”¨ç‡ä¸¥é‡è¿‡é«˜"
      condition: "system.cpu.usage > 95"
      duration: "2m"
      level: CRITICAL
      enabled: true
      tags: [system, cpu, critical]
      message: "CPUä½¿ç”¨ç‡ä¸¥é‡è¿‡é«˜: {{value}}%"
      actions:
        - type: notify
          channels: [slack, email, sms]
        - type: auto_scale
          enabled: false
    
    - name: high_memory_usage
      description: "å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜"
      condition: "system.memory.usage > 85"
      duration: "5m"
      level: WARNING
      enabled: true
      tags: [system, memory, performance]
      message: "å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜: {{value}}%"
      actions:
        - type: notify
          channels: [slack]
    
    - name: low_disk_space
      description: "ç£ç›˜ç©ºé—´ä¸è¶³"
      condition: "system.disk.usage > 90"
      duration: "1m"
      level: CRITICAL
      enabled: true
      tags: [system, disk, storage]
      message: "ç£ç›˜ç©ºé—´ä¸è¶³: {{value}}%"
      actions:
        - type: notify
          channels: [slack, email, sms]
        - type: cleanup
          enabled: true

    # åº”ç”¨æ€§èƒ½å‘Šè­¦
    - name: high_error_rate
      description: "åº”ç”¨é”™è¯¯ç‡è¿‡é«˜"
      condition: "app.error.rate > 0.05"  # 5%
      duration: "5m"
      level: ERROR
      enabled: true
      tags: [application, errors, performance]
      message: "åº”ç”¨é”™è¯¯ç‡è¿‡é«˜: {{value}}%"
      actions:
        - type: notify
          channels: [slack, email]
    
    - name: high_response_time
      description: "å“åº”æ—¶é—´è¿‡é•¿"
      condition: "app.response.time.p95 > 5000"  # 5ç§’
      duration: "10m"
      level: WARNING
      enabled: true
      tags: [application, performance, latency]
      message: "å“åº”æ—¶é—´è¿‡é•¿: {{value}}ms"
      actions:
        - type: notify
          channels: [slack]
    
    - name: low_throughput
      description: "ååé‡è¿‡ä½"
      condition: "app.throughput < 100"  # 100è¯·æ±‚/åˆ†é’Ÿ
      duration: "10m"
      level: WARNING
      enabled: true
      tags: [application, performance, throughput]
      message: "ååé‡è¿‡ä½: {{value}} è¯·æ±‚/åˆ†é’Ÿ"
      actions:
        - type: notify
          channels: [slack]

    # æ•°æ®åº“å‘Šè­¦
    - name: database_connection_error
      description: "æ•°æ®åº“è¿æ¥é”™è¯¯"
      condition: "database.connection.errors > 0"
      duration: "1m"
      level: CRITICAL
      enabled: true
      tags: [database, connection, critical]
      message: "æ•°æ®åº“è¿æ¥é”™è¯¯: {{value}} ä¸ªé”™è¯¯"
      actions:
        - type: notify
          channels: [slack, email, sms]
    
    - name: database_slow_query
      description: "æ•°æ®åº“æ…¢æŸ¥è¯¢"
      condition: "database.query.slow.count > 10"
      duration: "5m"
      level: WARNING
      enabled: true
      tags: [database, performance, query]
      message: "æ•°æ®åº“æ…¢æŸ¥è¯¢è¿‡å¤š: {{value}} ä¸ª"
      actions:
        - type: notify
          channels: [slack]

    # æœåŠ¡å¥åº·å‘Šè­¦
    - name: service_down
      description: "æœåŠ¡ä¸å¯ç”¨"
      condition: "service.health.status == 'down'"
      duration: "1m"
      level: CRITICAL
      enabled: true
      tags: [service, health, critical]
      message: "æœåŠ¡ä¸å¯ç”¨: {{service_name}}"
      actions:
        - type: notify
          channels: [slack, email, sms]
        - type: restart
          enabled: true
    
    - name: service_degraded
      description: "æœåŠ¡é™çº§"
      condition: "service.health.status == 'degraded'"
      duration: "2m"
      level: WARNING
      enabled: true
      tags: [service, health, performance]
      message: "æœåŠ¡é™çº§: {{service_name}}"
      actions:
        - type: notify
          channels: [slack]

    # å®‰å…¨å‘Šè­¦
    - name: security_brute_force
      description: "æš´åŠ›ç ´è§£æ”»å‡»"
      condition: "security.auth.failed.count > 10"
      duration: "5m"
      level: CRITICAL
      enabled: true
      tags: [security, auth, attack]
      message: "æ£€æµ‹åˆ°æš´åŠ›ç ´è§£æ”»å‡»: {{value}} æ¬¡å¤±è´¥ç™»å½•"
      actions:
        - type: notify
          channels: [slack, email, sms]
        - type: block_ip
          enabled: true
    
    - name: security_suspicious_activity
      description: "å¯ç–‘æ´»åŠ¨"
      condition: "security.suspicious.score > 0.8"
      duration: "1m"
      level: ERROR
      enabled: true
      tags: [security, suspicious]
      message: "æ£€æµ‹åˆ°å¯ç–‘æ´»åŠ¨: è¯„åˆ† {{value}}"
      actions:
        - type: notify
          channels: [slack, email]

    # ä¸šåŠ¡å‘Šè­¦
    - name: business_anomaly
      description: "ä¸šåŠ¡å¼‚å¸¸"
      condition: "business.anomaly.detected == true"
      duration: "5m"
      level: WARNING
      enabled: true
      tags: [business, anomaly]
      message: "æ£€æµ‹åˆ°ä¸šåŠ¡å¼‚å¸¸: {{anomaly_type}}"
      actions:
        - type: notify
          channels: [slack]
    
    - name: business_volume_spike
      description: "ä¸šåŠ¡é‡æ¿€å¢"
      condition: "business.volume.rate > business.volume.baseline * 2"
      duration: "5m"
      level: INFO
      enabled: true
      tags: [business, volume, spike]
      message: "ä¸šåŠ¡é‡æ¿€å¢: {{value}}%"
      actions:
        - type: notify
          channels: [slack]

  # å‘Šè­¦æŠ‘åˆ¶è§„åˆ™
  suppressions:
    - name: maintenance_window
      description: "ç»´æŠ¤çª—å£æœŸé—´æŠ‘åˆ¶å‘Šè­¦"
      condition: "maintenance.mode == true"
      rules: ["*"]
      duration: "maintenance.duration"
    
    - name: deployment_suppression
      description: "éƒ¨ç½²æœŸé—´æŠ‘åˆ¶å‘Šè­¦"
      condition: "deployment.in_progress == true"
      rules: ["high_error_rate", "high_response_time"]
      duration: "deployment.duration"

  # å‘Šè­¦èšåˆè§„åˆ™
  aggregations:
    - name: service_alerts
      description: "æŒ‰æœåŠ¡èšåˆå‘Šè­¦"
      group_by: ["service_name", "level"]
      window: "10m"
      threshold: 3
      message: "æœåŠ¡ {{service_name}} åœ¨10åˆ†é’Ÿå†…äº§ç”Ÿäº† {{count}} ä¸ª{{level}}çº§åˆ«å‘Šè­¦"

  # å‘Šè­¦å‡çº§è§„åˆ™
  escalations:
    - name: critical_escalation
      description: "ä¸¥é‡å‘Šè­¦å‡çº§"
      condition: "alert.level == 'CRITICAL' && alert.duration > '30m'"
      actions:
        - type: notify
          channels: [sms, phone]
          recipients: [oncall_engineer, team_lead]
    
    - name: unresolved_escalation
      description: "æœªè§£å†³å‘Šè­¦å‡çº§"
      condition: "alert.duration > '2h'"
      actions:
        - type: notify
          channels: [email, phone]
          recipients: [manager, director]

  # å‘Šè­¦æ¨¡æ¿
  templates:
    slack:
      title: "ğŸš¨ {{alert.level}} - {{alert.name}}"
      message: "{{alert.message}}"
      color: "{{alert.level.color}}"
      fields:
        - title: "æœåŠ¡"
          value: "{{alert.service_name}}"
          short: true
        - title: "æ—¶é—´"
          value: "{{alert.timestamp}}"
          short: true
        - title: "æŒç»­æ—¶é—´"
          value: "{{alert.duration}}"
          short: true
        - title: "æ ‡ç­¾"
          value: "{{alert.tags}}"
          short: false
    
    email:
      subject: "ğŸš¨ [{{alert.level}}] {{alert.name}}"
      body: |
        <h2>ğŸš¨ {{alert.level}} - {{alert.name}}</h2>
        <p><strong>æè¿°:</strong> {{alert.description}}</p>
        <p><strong>æ¶ˆæ¯:</strong> {{alert.message}}</p>
        <p><strong>æœåŠ¡:</strong> {{alert.service_name}}</p>
        <p><strong>æ—¶é—´:</strong> {{alert.timestamp}}</p>
        <p><strong>æŒç»­æ—¶é—´:</strong> {{alert.duration}}</p>
        <p><strong>æ ‡ç­¾:</strong> {{alert.tags}}</p>
        <p><strong>è¯¦æƒ…:</strong> <a href="{{alert.link}}">æŸ¥çœ‹è¯¦æƒ…</a></p>
    
    sms:
      message: "ğŸš¨ {{alert.level}}: {{alert.message}} ({{alert.service_name}})"

  # å‘Šè­¦å†å²é…ç½®
  history:
    retention_days: 365
    max_records: 100000
    compression: true
    backup_enabled: true
    backup_interval: "7d"

  # å‘Šè­¦ç»Ÿè®¡é…ç½®
  statistics:
    enabled: true
    aggregation_interval: "1h"
    metrics:
      - alert_count
      - alert_rate
      - alert_resolution_time
      - alert_escalation_rate
    reporting:
      daily: true
      weekly: true
      monthly: true